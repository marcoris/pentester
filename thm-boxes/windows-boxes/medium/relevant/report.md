---
description: Document v 0.0.9 - DRAFT
---

# Report

Here you can see the [Terms of contract](../../../../report.md) of this Penetration test.

## Executive Summary

Pentester Corp evaluated Demo Corp's interal security posture through penetration testing from March 11th, 2024 to March 15th, 2024. The following sections provide a high-level overview of vulnerabilities discovered, successfull and unsuccessful attempts, and strengths and weaknesses.

### Scoping and Time Limitations

Scoping during the engagement did not permit denial of service or social engineering across all testing components.

Time limitations were in place for testing. Internal network penetration teting was permitted for 5 business days.

### Testing Summary

The client wants to release his virtual environment to production in seven days. The client doesen't give any information and wants Pentester Corp to act like a malicious actor. In this case this is a black box penetration test.

The goal is to read two files mentioned as follow (in this case flags) with information as proof of exploitation:

* User.txt
* Root.txt

Additionally the client has provided the following scope allowances:

* Any tools or techniques are permitted in this engagement, however we ask that you attempt manual exploitation first
* Locate and note all vulnerabilities found
* Submit the flags discovered to the dashboard
* Only the IP address assigned to your machine is in scope
* Find and report ALL vulnerabilities (yes, there is more than one path to root)

The network assessment evaluated Demo Corp's internal network security posture. From an internal perspective, the Pentester Corp performed vulnerability scanning against all IPs provided by Demo Corp to evaluate the overall patching health of the network.

Pentester Corp discovered <mark style="color:blue;">**8 open ports**</mark>. Two of them are a webserver (IIS) and two are for the smb server.

With directory enumerating tools Pentester Corp has found a directory called <mark style="color:blue;">**nt4wrksv**</mark> on the webserver on port <mark style="color:blue;">**49663**</mark>. Further enumeration of the Samba service shows the content of a <mark style="color:blue;">**passwords.txt**</mark> file. There were base64 encoded credentials stored strings. Pentester Corp decoded the credentials and could login to the samba share with the credentials from a user (bob) and upload a reverse shell.

The reverse shell let Pentester Corp connect to the server where Pentester Corp could read the content of the <mark style="color:red;">**user.txt**</mark> file found on the users desktop.

The remainder of the findings were <mark style="color:red;">high</mark>, <mark style="color:orange;">moderate</mark>, <mark style="color:green;">low</mark>, or <mark style="color:blue;">informational</mark>. For further information on findings, please review the [Technical Findings](report.md#technical-findings) section.

### Tester Notes and Recommendations

During testing, three constants stood out: a weak password policy, an open accessible samba share and a user with too much privileges.

The weak password policy led to the initial compromise of an account and is usually one of the first footholds an attacker attempts to use in a network. The presence of a weak password policy is backed up by the evidence of the content of the file (passwords.txt) on the samba share encoded in base64.

We recommended that Demo Corp re-evaluates their current password policy and considers a policy of not storing any passwords in a file especially if it's open accessible. We also recommend that Demo Corp needs a password manager to store their passwords secretly. Finally, a Privilege Access Management solution should be considered.

### Key Strengths and Weaknesses

The following identifies the key strengths identified during the assessment:

1. Passwords are not in a common passwordlist like rockyou.txt

The following identifies the key weaknesses identified during the assessment:

1. Password policy found to be insufficient
2. Samba share was openly accessible (over webserver)
3. Samba share was not password protected
4. SeImpersonatePrivilege was enabled
5. The user Bob had too much privileges enabled

## Vulnerability Summary & Report Card

### Discovered weaknesses ~~and vulnerabilities~~

* CWE-250: Execution with Unnecessary Privileges
* CWE-257: Storing Passwords in a Recoverable Format
* CWE-269: Improper Privilege Management
* CWE-521: Weak Password Requirements
* CWE-862: Missing Authorization

The following tables illustrate the vulnerabilities found by impact and recommended remediations:

### Internal Penetration Test Findings

| 13                                       | 5                                       | 6                                           | 0                                     | 1                                              |
| ---------------------------------------- | --------------------------------------- | ------------------------------------------- | ------------------------------------- | ---------------------------------------------- |
| <mark style="color:red;">Critical</mark> | <mark style="color:orange;">High</mark> | <mark style="color:yellow;">Moderate</mark> | <mark style="color:green;">Low</mark> | <mark style="color:blue;">Informational</mark> |



<table><thead><tr><th>Finding</th><th width="156">Severity</th><th>Recommendation</th></tr></thead><tbody><tr><td>IPT-001: Missing Authorization</td><td>Critical</td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table>

## &#x20;Technical Findings

### Internal Penetration Test Findings

**Finding IPT-001: xxx (Critical)**



| Description: | xxx |
| ------------ | --- |
| Risk:        | xxx |
| System:      | All |
| Tools Used:  | xxx |
| References:  | xxx |

**Evidence**

Screenshots

**Remediation**

xxx

Finding IPT-00x: xxx (Informational)



<table><thead><tr><th width="84">Step</th><th>Action</th><th>Remediation</th></tr></thead><tbody><tr><td>1</td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table>

**Remediation**

Review action and remediation steps.

### Cleanup

As in the contract with the client discussed i remove all uploaded files and put back the backed up files to restore to the beginning.

I just uploaded the following files and did not manipulate existing files:

* PrintSpoofer64.exe
* shell.aspx

<figure><img src="../../../../.gitbook/assets/image (2) (1).png" alt=""><figcaption><p>Proof the files were removed</p></figcaption></figure>

## Additional reporting

Here you can see the [Additional Scans and Reports](../../../../additional-scans-and-reports.md) of this Penetration test.
