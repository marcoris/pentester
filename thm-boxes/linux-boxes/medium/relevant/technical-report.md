---
description: Penetration Testing Challenge
---

# Technical Report

## Disclaimer

A penetration test is considered a snapshot in time. The findings and recommendations reflect the information gathered during the assessment and not any changes or modifications made outside of that period.

Time-limited engagements do not allow for a full evaluation of all security controls. Pentester Corp prioritized the assessment to identify the weakest security controls an attacker would exploit. Pentester Corp recommends conducting similar assessments on an annual basis by internal or third-party assessors to ensure the continued success of the controls.

## Contact Information

| Name                                          | Title                                                               | Contact Information                                        |
| --------------------------------------------- | ------------------------------------------------------------------- | ---------------------------------------------------------- |
| <mark style="color:red;">**Demo Corp**</mark> |                                                                     |                                                            |
| <mark style="color:red;">John Smith</mark>    | <mark style="color:red;">Global Information Security Manager</mark> | <mark style="color:red;">Email: jsmith@democorp.com</mark> |
| **Pentester Corp**                            |                                                                     |                                                            |
| Sir Ocram                                     | Lead Penetration Tester                                             | Email: sirocram@pentester.com                              |

## Assessment Overview

From <mark style="color:orange;">March 11th, 2024 to March 15th, 2024</mark> <mark style="color:red;">Demo Corp</mark> engaged Pentester Corp to evaluate the security posture of its infrastructure compared to current industry best practices that included an internal network penetration test. All testing performed is based on the <mark style="color:purple;">NIST SP 800-115 Technical Guide to Information Security Testing and Assessment, OWASP Testing Guide (v4)</mark>, and customized testing frameworks.

Phases of penetration testing activities include the following:

* Planning - Customer goals are gathered and rules of engagement obtained.
* Discovery - Perform scanning and enumeration to identify potential vulnerabilities, weak areas, and exploits.
* Attack - Confirm potential vulnerabilities through exploitation and perform additional discovery upon new access.
* Reporting - Document all found vulnerabilities and exploits, failed attempts, and company strengths and weaknesses.

<figure><img src="../../../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

## Assessment Components

### Internal Penetration Test

An internal penetration test emulates the role of an attacker from inside the network. An engineer will scan the network to identify potential host vulnerabilities and perform common and advanced internal network attacks, such as: LLMNR/NBT-NS poisoning and other man- in-the-middle attacks, token impersonation, kerberoasting, pass-the-hash, golden ticket, and more. The engineer will seek to gain access to hosts through lateral movement, compromise domain user and admin accounts, and exfiltrate sensitive data.

### External Penetration Test

External penetration testing is a security assessment that simulates the tactics and techniques of real-world attackers to identify and exploit vulnerabilities in an organization’s external systems and networks. It is conducted by an external security team that encompasses a detailed source code review, and manual inspections.

Commonly, such external penetration testing is performed for web apps, mobile apps, network & network devices, and so on.

## Finding Severity Ratings

The following table defines levels of severity and corresponding CVSS score range that are used throughout the document to assess vulnerability and risk impact.

<figure><img src="../../../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

## Risk Factors

Risk is measured by two factors: Likelihood and Impact:

#### Likelihood <a href="#bookmark9" id="bookmark9"></a>

Likelihood measures the potential of a vulnerability being exploited. Ratings are given based on the difficulty of the attack, the available tools, attacker skill level, and client environment.

#### Impact <a href="#bookmark10" id="bookmark10"></a>

Impact measures the potential vulnerability's effect on operations, including confidentiality, integrity, and availability of client systems and/or data, reputational harm, and financial loss.

## Scope

<table><thead><tr><th>Assessment</th><th>Details</th><th data-hidden></th></tr></thead><tbody><tr><td>Internal Penetration Test</td><td><mark style="color:red;">10.x.x.x/8</mark></td><td></td></tr></tbody></table>

### Scope Exclusion

Per client request, Pentester Corp did not perform any of the following attacks during testing:

* Denial of Service (DoS)
* Phishing/Social Engineering

### Client Allowances

<mark style="color:red;">Demo Corp</mark> provided Pentester Corp the following allowances:

* Internal access to network via port allowances

## Executive Summary

Pentester Corp evaluated <mark style="color:red;">Demo Corp</mark>'s interal security posture through penetration testing from <mark style="color:orange;">March 11th, 2024 to March 15th, 2024</mark>. The following sections provide a high-level overview of vulnerabilities discovered, successfull and unsuccessful attempts, and strengths and weaknesses.

### Scoping and Time Limitations

Scoping during the engagement did not permit denial of service or social engineering across all testing components.

Time limitations were in place for testing. Internal network penetration teting was permitted for <mark style="color:red;">5</mark> business days.

### Testing Summary

<mark style="color:red;">The client wants to release his virtual environment to production in seven days. The client doesen't give any information and wants me to act like a malicious actor. In this case this is a black box penetration test.</mark>

<mark style="color:red;">The goal is to read two files mentioned as follow (in this case flags) with information as proof of exploitation:</mark>

* <mark style="color:red;">User.txt</mark>
* <mark style="color:red;">Root.txt</mark>

<mark style="color:red;">Additionally the client has provided the following scope allowances:</mark>

* <mark style="color:red;">Any tools or techniques are permitted in this engagement, however we ask that you attempt manual exploitation first</mark>
* <mark style="color:red;">Locate and note all vulnerabilities found</mark>
* <mark style="color:red;">Submit the flags discovered to the dashboard</mark>
* <mark style="color:red;">Only the IP address assigned to your machine is in scope</mark>
* <mark style="color:red;">Find and report ALL vulnerabilities (yes, there is more than one path to root)</mark>

The network assessment evaluated Demo Corp's internal network security posture. From an internal perspective, the Pentester Corp performed vulnerability scanning against all IPs provided by Demo Corp to evaluate the overall patching health of the network.

<mark style="color:blue;">Pentester Corp discovered 8 open ports. Two of them are a webserver (IIS) and two are for the smb server.</mark>

<mark style="color:blue;">With directory enumerating tools i have found a directory called nt4wrksv on the webserver on port 49663. Further enumeration of the samba server shows the content of a passwords.txt file. there were credentials stored as base64 strings. I could login to the samba share with the credentials from a user and upload s reverse shell.</mark>

<mark style="color:blue;">The reverse shell let me connect to the server where i could read the content of the user.txt file found on the users desktop.</mark>

&#x20;

&#x20;<mark style="color:blue;">User.txt</mark>

<mark style="color:blue;">THM{</mark>~~<mark style="color:blue;">fdk4ka34vk346ksxfr21tg789ktf45</mark>~~<mark style="color:blue;">}</mark>

<mark style="color:blue;">Root.txt</mark>

<mark style="color:blue;">THM{</mark>~~<mark style="color:blue;">1fk5kf469devly1gl320zafgl345pv</mark>~~<mark style="color:blue;">}</mark>

&#x20;

&#x20;The remainder of the findings were high, moderate, low, or informational. For further information on findings, please review the Technical Findings section.

## External Reconnaissance

As we are allowed to use all tools we wnt i start with an nmap scan first.

&#x20;

`sudo nmap -sC -sV -O -oN nmap/scan <IP>`

&#x20;

\-sC ...

&#x20;

We get back the following ports:

* Port 80: running Microsoft IIS httpd 10.0
* Port 135: running Microsoft Windows RPC
* Port 139: running netbios
* Port 445: running Windows Server 2016 Standard Evaluation 14396
* Port 3389: running Microsoft Terminal Services

### Additional Scans and Reports

TCMS provides all clients with all report information gathered during testing. This includes Nessus files and full vulnerability scans in detailed formats. These reports contain raw vulnerability scans and additional vulnerabilities not exploited by TCM Security.

\


The reports identify hygiene issues needing attention but are less likely to lead to a breach, i.e. defense-in-depth opportunities. For more information, please see the documents in your shared drive folder labeled “Additional Scans and Reports”.

## Cleanup

As in the contract with the client discussed i remove all uploaded files and put back the backed up files to restore to the beginning.

I just uploaded the following files and did not manipulate existing files:

* PrintSpoofer64.exe
* shell.aspx

<figure><img src="../../../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>
