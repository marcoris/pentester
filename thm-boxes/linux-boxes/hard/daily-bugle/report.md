---
description: Document v 1.0.0
---

# Report

Here you can see the [Terms of contract](../../../../report.md) of this Penetration test.

## Executive Summary

Pentester Corp evaluated Demo Corp's interal security posture through penetration testing from March 18th, 2024 to March 22th, 2024. The following sections provide a high-level overview of vulnerabilities discovered, successfull and unsuccessful attempts, and strengths and weaknesses.

### Scoping and Time Limitations

Scoping during the engagement did not permit denial of service or social engineering across all testing components.

Time limitations were in place for testing. External and Internal network penetration testing was permitted for 5 business days.

### Testing Summary

The client wants to get tested on SQLInjection on the own hosted Joomla CMS. The client also wants Penterster Corp to compromise a Joomla account. Pentester Corp then can escalate privileges if it's possible.

The goal is to read two files mentioned as follow (in this case flags) with information as proof of exploitation:

* user.txt
* root.txt

Additionally the client has provided the following scope allowances:

* Any tools or techniques are permitted in this engagement
* Locate and note all vulnerabilities found
* Submit the flags discovered to the dashboard
* Only the IP address assigned to your machine is in scope
* Find and report ALL vulnerabilities

The network assessment evaluated Demo Corp's external and internal network security posture. From an external perspective, the Pentester Corp performed vulnerability scanning against all IPs provided by Demo Corp to evaluate the privilege escalation on a compromised user.

Pentester Corp discovered <mark style="color:blue;">**3 open ports**</mark>. One is running a web server, one is running SSH and the last is running a MySQL database. All on common ports.

There doesn't have to be a directory enumeration because the "hidden" directory <mark style="color:blue;">**administrator**</mark> was showed in the robots.txt file to prevent search engeines from indexing it.

The deprecated Joomla version was found in the Joomla manifest file (administrator/manifests/files/joomla.xml) that is accessible for the WWW.

The outdated Joomla version led to an SQLInjection and leaked the login data from the database.

The found and reused credentials from the Joomla configuration file (configuration.php) let Pentester Corp login via SSH connection to Jonah's local account and read the content of <mark style="color:red;">**user.txt**</mark> found in his home directory.

**Evidence**

27a2<mark style="color:red;">\[ZENSORED]</mark>442e

The user jjameson had sudo access with no password on the `yum` binary so Pentester Corp could perform a privilege escalation via that binary and read the content of the <mark style="color:red;">**root.txt**</mark> file found on the root directory.

**Evidence**

eec3<mark style="color:red;">\[ZENSORED]</mark>6f79

The remainder of the findings were <mark style="color:red;">critical</mark>, <mark style="color:orange;">high</mark> or <mark style="color:blue;">informational</mark>. For further information on findings, please review the [Technical Findings](report.md#technical-findings) section.

### Tester Notes and Recommendations

During testing, two constants stood out: a weak password policy, and a deprecated Joomla version was found.

The deprecated Joomla version has a vilnerability that leaks database informations. With that information it was possible to get user credentials as user:hashedpassword.

The weak password policy led to the initial compromise of a Joomla account (jonah) and upload and run a reverse shell and is usually one of the first footholds an attacker attempts to use on a web server. The presence of a weak password policy is backed up by the evidence of cracking a weak password in a couple of seconds.

We have recommended that Demo Corp review their current Update- and Patch-Management to prevent their software from being outdated and vulnerable.

The password policy should prohibit the use of weak and reused passwords. We also recommend that Demo Corp needs a password manager to store their passwords secretly. Finally, an Update Management solution should be considered.

### Key Strengths and Weaknesses

The following identifies the key strengths identified during the assessment:

1. Brute force attacks against the login form did not work because of a Web Application Firewall.

The following identifies the key weaknesses identified during the assessment:

1. Update management found to be insufficient
2. Password policy found to be insufficient

## Vulnerability Summary & Report Card

### Discovered vulnerabilities

* CVE 2017-8917 (Joomla 3.7.0 SQL injection)

### Discovered weaknesses

**OWASP Top 10 2021**

* A06:2021 – Vulnerable and Outdated Components

**CWE MITRE**

* CWE-250: Execution with Unnecessary Privileges
* CWE-257: Storing Passwords in a Recoverable Format
* CWE-269: Improper Privilege Management
* CWE-521: Weak Password Requirements

The following tables illustrate the vulnerabilities found by impact and recommended remediations:

### External Penetration Test Findings

| 2                                        | 0                                       | 0                                           | 0                                     | 0                                              |
| ---------------------------------------- | --------------------------------------- | ------------------------------------------- | ------------------------------------- | ---------------------------------------------- |
| <mark style="color:red;">Critical</mark> | <mark style="color:orange;">High</mark> | <mark style="color:yellow;">Moderate</mark> | <mark style="color:green;">Low</mark> | <mark style="color:blue;">Informational</mark> |

<table><thead><tr><th width="310">Finding</th><th width="105">Severity</th><th>Recommendation</th></tr></thead><tbody><tr><td>EPT-001: Insufficient Patch Management – Software</td><td><mark style="color:red;">Critical</mark></td><td>Update to the latest software version.</td></tr><tr><td>EPT-002: Insufficient Password policy</td><td><mark style="color:red;">Critical</mark></td><td>Use a password manager to generate strong and unique passwords.</td></tr></tbody></table>

### Internal Penetration Test Findings

| 1                                        | 1                                       | 0                                           | 0                                     | 1                                              |
| ---------------------------------------- | --------------------------------------- | ------------------------------------------- | ------------------------------------- | ---------------------------------------------- |
| <mark style="color:red;">Critical</mark> | <mark style="color:orange;">High</mark> | <mark style="color:yellow;">Moderate</mark> | <mark style="color:green;">Low</mark> | <mark style="color:blue;">Informational</mark> |

<table><thead><tr><th width="271">Finding</th><th width="133">Severity</th><th>Recommendation</th></tr></thead><tbody><tr><td>IPT-001: Insufficient Password policy</td><td><mark style="color:red;">Critical</mark></td><td>Use a password manager to save strong and unique passwords and not in files.</td></tr><tr><td>IPT-002: Insufficient Privileged User Management</td><td><mark style="color:orange;">High</mark></td><td>Limit local admin users via least privilege.</td></tr><tr><td>IPT-003: Steps to root</td><td><mark style="color:blue;">Informational</mark></td><td>Review action and remediation steps.</td></tr></tbody></table>

## Technical Findings

### External Penetration Test Findings

Finding EPT-001: Insufficient Patch Management – Software (<mark style="color:red;">Critical</mark>)

<table data-header-hidden><thead><tr><th width="137"></th><th></th></tr></thead><tbody><tr><td>Description:</td><td>Demo Corp has an outdated Joomla version.</td></tr><tr><td>Risk:</td><td>Likelihood: High - Adversaries will discover the version with low-noise, basic reconnaissance techniques.<br><br>Impact: High - An attacker can leak credentials from the database.</td></tr><tr><td>System:</td><td>Joomla 3.7.0 on apache 2.4.6</td></tr><tr><td>Tools Used:</td><td>sqlmap</td></tr><tr><td>References:</td><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8917">CVE-2017-8917 SQL injection vulnerability in Joomla 3.7.x</a></td></tr></tbody></table>

**Evidence**

<figure><img src="../../../../.gitbook/assets/image (65).png" alt=""><figcaption></figcaption></figure>

**Remediation**

Update to the latest software version.



Finding EPT-002: Insufficient Password policy (<mark style="color:red;">Critical</mark>)

<table data-header-hidden><thead><tr><th width="137"></th><th></th></tr></thead><tbody><tr><td>Description:</td><td>Demo Corp has a user account on the Joomla CMS with a weak password.</td></tr><tr><td>Risk:</td><td>Likelihood: Very High - Adversaries will brute-force the password with low-noise, basic password cracking techniques.<br><br>Impact: Very High - An attacker can login to the Joomla account and upload a reverse shell.</td></tr><tr><td>System:</td><td>Joomla 3.7.0 on apache 2.4.6</td></tr><tr><td>Tools Used:</td><td>john</td></tr><tr><td>References:</td><td><a href="https://cwe.mitre.org/data/definitions/521.html">CWE-521: Weak Password Requirements</a></td></tr></tbody></table>

**Evidence**

<figure><img src="../../../../.gitbook/assets/image (61).png" alt=""><figcaption></figcaption></figure>

**Remediation**

Never use weak passwords. Generate strong passwords with a password manager like [1Password](https://1password.com/), [keepass](https://keepass.info/), [C2 Password](https://c2.synology.com/) or an other. Overthinking the Password policy can protect an attacker from abusing the system. Even if the passwords are stored in a password manager and the passwords cannot be found in a common password list such as rockyou.txt it is still possible to gain access to the system using brute force methods. Password manager generate passwords in various length and characters - and you dont have to remember them.



### Internal Penetration Test Findings

Finding IPT-001: Insufficient Password policy (<mark style="color:red;">Critical</mark>)

<table data-header-hidden><thead><tr><th width="137"></th><th></th></tr></thead><tbody><tr><td>Description:</td><td>The user jjameson has stored and reused his password in the configuration.php file.</td></tr><tr><td>Risk:</td><td>Likelihood: Very High - Adversaries can read the configuration file with no noise an the target.<br><br>Impact: Very High - An attacker can login to a higher privileged user on the system.</td></tr><tr><td>System:</td><td>All</td></tr><tr><td>Tools Used:</td><td>cat</td></tr><tr><td>References:</td><td><a href="https://cwe.mitre.org/data/definitions/521.html">CWE-257: Storing Passwords in a Recoverable Format</a><br><a href="https://cwe.mitre.org/data/definitions/521.html">CWE-521: Weak Password Requirements</a></td></tr></tbody></table>

**Evidence**

<figure><img src="../../../../.gitbook/assets/image (63).png" alt=""><figcaption></figcaption></figure>

**Remediation**

Never store passwords in a file. You can see more details for this finding described in EPT-002.



Finding IPT-002: Insufficient Privileged User Management (<mark style="color:orange;">High</mark>)

<table data-header-hidden><thead><tr><th width="137"></th><th></th></tr></thead><tbody><tr><td>Description:</td><td>The user jjameson had sudo privileges on the yum binary.</td></tr><tr><td>Risk:</td><td>Likelihood: High - The binary can run with root privileges.<br><br>Impact: Very High - Hijacking of the system.</td></tr><tr><td>System:</td><td>All</td></tr><tr><td>Tools Used:</td><td>yum, python, cat</td></tr><tr><td>References:</td><td><a href="https://cwe.mitre.org/data/definitions/250.html">CWE-250: Execution with Unnecessary Privileges</a><br><a href="https://cwe.mitre.org/data/definitions/269.html">CWE-269: Improper Privilege Management</a></td></tr></tbody></table>

**Evidence**

<figure><img src="../../../../.gitbook/assets/image (64).png" alt=""><figcaption></figcaption></figure>

**Remediation**

Limit local admin users via least privilege. Disable all privileges on all users.



Finding IPT-003: Steps to root (<mark style="color:blue;">Informational</mark>)

The steps below describe how the penetration tester obtained root access. Each step also provides remediation recommendations to help mitigate risk.

<table><thead><tr><th width="82">Step</th><th>Action</th><th>Remediation</th></tr></thead><tbody><tr><td>1</td><td>Login with reused password found in configuration.php.</td><td>Never reuse passwords.</td></tr><tr><td>2</td><td>Run sudo -l to list sudoer binaries</td><td>Limit local administrator privileges.</td></tr><tr><td>3</td><td>Run the exploit to gain root</td><td>Enforce least privilege on all users.</td></tr></tbody></table>

**Remediation**

Review action and remediation steps.

### Cleanup

As in the contract with the client discussed Pentester Corps remove all uploaded files and put back the backed up files to restore to the beginning.

Pentester Corp just uploaded the following files and manipulate the existing file index.php:

* linpeas.sh
* enum4linux.sh

<figure><img src="../../../../.gitbook/assets/image (59).png" alt=""><figcaption></figcaption></figure>

Removing the temporary generated directory from the privilage escalation exploit.

<figure><img src="../../../../.gitbook/assets/image (62).png" alt=""><figcaption></figcaption></figure>

## Additional reporting

Here you can see the [Additional Scans and Reports](../../../../additional-scans-and-reports.md) of this Penetration test.
