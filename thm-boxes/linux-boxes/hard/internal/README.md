---
description: Penetration Testing Challenge (WIP)
---

# Internal

## Reconnaissance

As always i ran nmap to list open ports.

`sudo nmap -sC -sV -O -oN nmap/scan <IP>`

* **-sC**: run default nmap scripts
* **-sV**: detect service version
* **-O**: detect OS
* **-oN**: output normal format and store in file nmap/scan

I get back the following result showing that these ports are open:

* **Port 22**: running OpenSSH 7.6p1 on Ubuntu
* Port 80: running Apache httpd 2.4.29 on Ubuntu

<figure><img src="../../../../.gitbook/assets/image (42).png" alt=""><figcaption></figcaption></figure>

## Enumeration

<figure><img src="../../../../.gitbook/assets/image (43).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (44).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (45).png" alt=""><figcaption></figcaption></figure>

Found a blog directory on the server. Especially e blog with the CMS WordPress. To enumerate further i can do that with wappalyzer:

<figure><img src="../../../../.gitbook/assets/image (46).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (47).png" alt=""><figcaption></figcaption></figure>

Could be a legitimate user on the CMS.

<figure><img src="../../../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (49).png" alt=""><figcaption></figcaption></figure>

The error message proofs that there is a user called admin.

First i saved the request from Burp in a file:

<figure><img src="../../../../.gitbook/assets/image (50).png" alt=""><figcaption></figcaption></figure>

**Doing it the hydra-way**

hydra -l admin -P /usr/share/wordlists/rockyou.txt -f 10.10.15.92 http-form-post "//blog/wp-login.php:log=^USER^\&pwd=^PASS^:F=is incorrect." -V

<figure><img src="../../../../.gitbook/assets/image (51).png" alt=""><figcaption></figcaption></figure>

**Doing it the fuzz way**

`ffuf -request req -request-proto http -w /usr/share/wordlists/rockyou.txt:FUZZPASS -t 100 -fs 4941`

<figure><img src="../../../../.gitbook/assets/image (53).png" alt=""><figcaption></figcaption></figure>

**External Enumeration Summary:**

* OS: Ubuntu
* Webserver: Apache httpd 2.4.29
* CMS: WordPress 5.4.2
* Database: MySQL
* Credentials: admin:my2boys

## Exploitation #1: WordPress Theme (Reverse Shell)

Go to the Template Editor from:

`Appearance > Theme Editor > index.php`

Backup the index.php on the system as index.php.bak

Override index.php with PHP reverse shell code and start up a netcat listener on port 4444.

`cat shell.php | xclip -selection clipboard`

<figure><img src="../../../../.gitbook/assets/image (52).png" alt=""><figcaption></figcaption></figure>



**Internal Enumeration summary**

* User: aubreanna



## Privilege Escalation



## Discovered vulnerabilities

1. CWE-204: Observable Response Discrepancy
2. CWE-521: Weak Password Requirements
3. CWE-257: Storing Passwords in a Recoverable Format
4. ~~CWE-269: Improper Privilege Management~~
5. ~~CWE-250: Execution with Unnecessary Privileges~~

## Lessons learned

1. In most CTF don't go further away to investigate for the next privesc. Firt have a look in your own environment especialy when it's a CMS that was recently exploited.
