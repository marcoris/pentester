---
description: Document v 1.0.0
---

# Report

Here you can see the [Terms of contract](../../../../report.md) of this Penetration test.

## Executive Summary

Demo Corp requests that an engineer conducts an external, web app, and internal assessment of the provided virtual environment. The minimal information provided by Demo Corp  results in Pentester Corp acting like a malicious actor (black box testing).

Pentester Corp evaluated Demo Corp's interal security posture through penetration testing from March 25th, 2024 to April 12th, 2024. The following sections provide a high-level overview of vulnerabilities discovered, successfull and unsuccessful attempts, and strengths and weaknesses.

### Scoping and Time Limitations

Scoping during the engagement did not permit denial of service or social engineering across all testing components.

Time limitations were in place for testing. External and Internal network penetration testing was permitted for 15 business days.

### Testing Summary

The client wants to release his virtual environment to production in three weeks. The client doesen't give any information and wants Pentester Corp to act like a malicious actor. In this case this is a black box penetration test.

He also wants that Pentester Corp conduct an external web app and internal assessment of the provided virtual environment.

The goal is to read two files mentioned as follow (in this case flags) with information as proof of exploitation:

* user.txt
* root.txt

Additionally the client has provided the following scope allowances:

* Ensure that the hosts file is modified to reflect internal.thm
* Any tools or techniques are permitted in this engagement
* Locate and note all vulnerabilities found
* Submit the flags discovered to the dashboard
* Only the IP address assigned to your machine is in scope

The network assessment evaluated Demo Corp's external and internal network security posture. From an external perspective, the Pentester Corp performed vulnerability scanning against all IPs provided by Demo Corp to evaluate the privilege escalation on a compromised user.

Pentester Corp discovered <mark style="color:blue;">**2 open ports**</mark>. One is running a web server and one is running SSH. All on common ports.

The directory <mark style="color:blue;">**blog**</mark> was found with gobuster and the call proofs that there is WordPress running on it.

The weak password from the admin (default user) user let Pentester Corp login and get a reverse shell. With linpeas Pentester Corp found a password stored as plaintext in a file in the <mark style="color:blue;">**opt**</mark> directory and could connect via SSH connection to `a********`'s local account and read the content of <mark style="color:red;">**user.txt**</mark> found in the home directory.

**Evidence**

THM{int3<mark style="color:red;">\[REDACTED]</mark>4g\_1}

The user `a********` had a jenkins.txt in the home directory with a hint of the ip of the running jenkins service. Pentester Corp could perform ssh tunneling and brute force the admin (default user) password of the jenkins user. Pentester Corp ran a reverse shell on the jenkins (run in a docker container) script console and could read the notes.txt in the opt directory. With the password found in that file Pentester Corp could switch from the user `a********` to the root user.

The root user had the <mark style="color:red;">**root.txt**</mark> file in the home directory.

**Evidence**

THM{d0ck<mark style="color:red;">\[REDACTED]</mark>0y3r}

The remainder of the findings were <mark style="color:red;">critical</mark> or <mark style="color:blue;">informational</mark>. For further information on findings, please review the [Technical Findings](report.md#technical-findings) section.

### Tester Notes and Recommendations

During testing, one constant stood out: a weak password policy was found.

The weak password policy led to the initial compromise of a WordPress account (a\*\*\*\*) and upload and run a reverse shell and is usually one of the first footholds an attacker attempts to use on a web server. The presence of a weak password policy is backed up by the evidence of cracking a weak password in a couple of seconds.

The password policy should prohibit the use of weak and stored passwords. We also recommend that Demo Corp needs a password manager to store their passwords secretly.

### Key Strengths and Weaknesses

The following identifies the key strengths identified during the assessment:

1. Many credentials were fake.

The following identifies the key weaknesses identified during the assessment:

1. Password policy found to be insufficient.

## Vulnerability Summary & Report Card

### Discovered vulnerabilities&#x20;

\-

### Discovered and weaknesses

* CWE-521: Weak Password Requirements
* CWE-257: Storing Passwords in a Recoverable Format
* CWE-1392: Use of Default Credentials

The following tables illustrate the vulnerabilities found by impact and recommended remediations:

### External Penetration Test Findings

| 1                                        | 0                                       | 0                                           | 0                                     | 0                                              |
| ---------------------------------------- | --------------------------------------- | ------------------------------------------- | ------------------------------------- | ---------------------------------------------- |
| <mark style="color:red;">Critical</mark> | <mark style="color:orange;">High</mark> | <mark style="color:yellow;">Moderate</mark> | <mark style="color:green;">Low</mark> | <mark style="color:blue;">Informational</mark> |

<table><thead><tr><th width="310">Finding</th><th width="105">Severity</th><th>Recommendation</th></tr></thead><tbody><tr><td>EPT-001: Insufficient Password policy</td><td><mark style="color:red;">Critical</mark></td><td>Use a password manager to generate strong and unique passwords.</td></tr></tbody></table>

### Internal Penetration Test Findings

| 1                                        | 0                                       | 0                                           | 0                                     | 0                                              |
| ---------------------------------------- | --------------------------------------- | ------------------------------------------- | ------------------------------------- | ---------------------------------------------- |
| <mark style="color:red;">Critical</mark> | <mark style="color:orange;">High</mark> | <mark style="color:yellow;">Moderate</mark> | <mark style="color:green;">Low</mark> | <mark style="color:blue;">Informational</mark> |

<table><thead><tr><th width="296">Finding</th><th width="134">Severity</th><th>Recommendation</th></tr></thead><tbody><tr><td>IPT-001: Insufficient Password policy</td><td><mark style="color:red;">Critical</mark></td><td>Use a password manager to generate strong and unique passwords.</td></tr><tr><td>IPR-002: Steps to root</td><td><mark style="color:blue;">Informational</mark></td><td>Review action and remediation steps.</td></tr></tbody></table>

## Technical Findings

### External Penetration Test Findings

**Finding EPT-001: Insufficient Password policy (**<mark style="color:red;">**Critical**</mark>**)**

<table data-header-hidden><thead><tr><th width="137"></th><th></th></tr></thead><tbody><tr><td>Description:</td><td>Demo Corp has a Blog CMS called WordPress on the Webserver. The credentials are weak.</td></tr><tr><td>Risk:</td><td>Likelihood: Very High - Adversaries will find the username and will brute-force the password.<br><br>Impact: Very High - An attacker can ge the right password and login to the WordPress blog as admin user.</td></tr><tr><td>System:</td><td>WordPress, web server</td></tr><tr><td>Tools Used:</td><td>wappalyzer, hydra, ffuf, wpscan, burpsuite</td></tr><tr><td>References:</td><td><a href="https://cwe.mitre.org/data/definitions/521.html">CWE-521: Weak Password Requirements</a></td></tr></tbody></table>

**Evidence**

<figure><img src="../../../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

**Remediation**

Never use weak passwords. Generate strong passwords with a password manager like [1Password](https://1password.com/), [keepass](https://keepass.info/), [C2 Password](https://c2.synology.com/) or an other. Overthinking the Password policy can protect an attacker from abusing the system. Even if the passwords are stored in a password manager and the passwords cannot be found in a common password list such as rockyou.txt it is still possible to gain access to the system using brute force methods. Password manager generate passwords in various length and characters - and you dont have to remember them.



### Internal Penetration Test Findings

**Finding IPT-001: Insufficient Password policy (**<mark style="color:red;">**Critical**</mark>**)**

<table data-header-hidden><thead><tr><th width="137"></th><th></th></tr></thead><tbody><tr><td>Description:</td><td>User Bill stored credentials as plaintext in a file with all world reading permission.</td></tr><tr><td>Risk:</td><td>Likelihood: High - The file can be read from any user on the system.<br><br>Impact: Very High - Logging in as higher privileged user.</td></tr><tr><td>System:</td><td>All</td></tr><tr><td>Tools Used:</td><td>cat</td></tr><tr><td>References:</td><td><a href="https://cwe.mitre.org/data/definitions/521.html">CWE-521: Weak Password Requirements</a></td></tr></tbody></table>

**Evidence**

<figure><img src="../../../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

**Remediation**

Never store passwords in a recoverable file. Save passwords instead in a password manager like [1Password](https://1password.com/), [keepass](https://keepass.info/), [C2 Password](https://c2.synology.com/) or an other. Overthinking the Password policy can protect an attacker from abusing the system. Even if the passwords are stored in a password manager and the passwords cannot be found in a common password list such as rockyou.txt it is still possible to gain access to the system using brute force methods. Password manager generate passwords in various length and characters - and you dont have to remember them.



**Finding IPT-002: Steps to root (**<mark style="color:blue;">**Informational**</mark>**)**

The steps below describe how the penetration tester obtained root access. Each step also provides remediation recommendations to help mitigate risk.

<table><thead><tr><th width="82">Step</th><th>Action</th><th>Remediation</th></tr></thead><tbody><tr><td>1</td><td>Login with weak credentials (and defaut loginuser).</td><td>Add lower privileged user with strong password.</td></tr><tr><td>2</td><td>Run reverse shell in "script console".</td><td>Limit running the script console.</td></tr><tr><td>3</td><td>Switch user with found credentials stored on the docker container.</td><td>Remove files with credentials especially in plaintext</td></tr></tbody></table>

**Remediation**

Review action and remediation steps.

### Cleanup

Restore the backup from the index.php.bak file on the server as index.php.

Remove linpease.sh and enum.sh from the server.

## Additional reporting

Here you can see the [Additional Scans and Reports](../../../../additional-scans-and-reports.md) of this Penetration test.
