---
description: Document v 0.0.9 - DRAFT (WIP)
---

# Report

Here you can see the [Terms of contract](../../../../report.md) of this Penetration test.

## Executive Summary

Pentester Corp evaluated Demo Corp's interal security posture through penetration testing from March 11th, 2024 to March 15th, 2024. The following sections provide a high-level overview of vulnerabilities discovered, successfull and unsuccessful attempts, and strengths and weaknesses.

### Scoping and Time Limitations

Scoping during the engagement did not permit denial of service or social engineering across all testing components.

Time limitations were in place for testing. External and Internal network penetration testing was permitted for 5 business days.

### Testing Summary

The client wants to release his virtual environment to production in three weeks. The client doesen't give any information and wants me to act like a malicious actor. In this case this is a black box penetration test.

He also wants that Pentester Corp conduct an external web app and internal assessment of the provided virtual environment.

The goal is to read two files mentioned as follow (in this case flags) with information as proof of exploitation:

* User.txt
* Root.txt

Additionally the client has provided the following scope allowances:

* Ensure that the hosts file is modified to reflect internal.thm
* Any tools or techniques are permitted in this engagement
* Locate and note all vulnerabilities found
* Submit the flags discovered to the dashboard
* Only the IP address assigned to your machine is in scope

### Tester Notes and Recommendations

xxx

### Key Strengths and Weaknesses

The following identifies the key strengths identified during the assessment:

1. Passwords are not found in a common passwordlist like rockyou.txt

The following identifies the key weaknesses identified during the assessment:

1. Password policy found to be insufficient

## Vulnerability Summary & Repor Card

### Discovered weaknesses

* CWE-xxx: xxx

The following tables illustrate the vulnerabilities found by impact and recommended remediations:

### External Penetration Test Findings

| 0                                        | 0                                       | 0                                           | 0                                     | 0                                              |
| ---------------------------------------- | --------------------------------------- | ------------------------------------------- | ------------------------------------- | ---------------------------------------------- |
| <mark style="color:red;">Critical</mark> | <mark style="color:orange;">High</mark> | <mark style="color:yellow;">Moderate</mark> | <mark style="color:green;">Low</mark> | <mark style="color:blue;">Informational</mark> |

<table><thead><tr><th width="310">Finding</th><th width="105">Severity</th><th>Recommendation</th></tr></thead><tbody><tr><td>EPT-001: Unauthenticated SMB Share Access</td><td><mark style="color:yellow;">Moderate</mark></td><td>Set a password for the SMB share.</td></tr></tbody></table>

### Internal Penetration Test Findings

| 0                                        | 0                                       | 0                                           | 0                                     | 0                                              |
| ---------------------------------------- | --------------------------------------- | ------------------------------------------- | ------------------------------------- | ---------------------------------------------- |
| <mark style="color:red;">Critical</mark> | <mark style="color:orange;">High</mark> | <mark style="color:yellow;">Moderate</mark> | <mark style="color:green;">Low</mark> | <mark style="color:blue;">Informational</mark> |

<table><thead><tr><th width="296">Finding</th><th width="134">Severity</th><th>Recommendation</th></tr></thead><tbody><tr><td>IPT-001: Insufficient Privileged User Management</td><td><mark style="color:red;">Critical</mark></td><td>Limit local admin users via least privilege.</td></tr></tbody></table>

## Technical Findings

### External Penetration Test Findings

Finding EPT-001: Missing Authorization (<mark style="color:yellow;">Moderate</mark>)

<table data-header-hidden><thead><tr><th width="137"></th><th></th></tr></thead><tbody><tr><td>Description:</td><td>Demo Corp has a Samba share on the server with unauthenticated access.</td></tr><tr><td>Risk:</td><td>Likelihood: Moderate - Adversaries will discover these shares with low-noise, basic reconnaissance techniques.<br><br>Impact: Moderate - An attacker can upload a malicious file (a reverse shell) to gain a foothold on the server.</td></tr><tr><td>System:</td><td>Samba share on 10.x.x.x</td></tr><tr><td>Tools Used:</td><td>smbclient</td></tr><tr><td>References:</td><td><a href="https://cwe.mitre.org/data/definitions/862.html">CWE-862: Missing Authorization</a></td></tr></tbody></table>

**Evidence**

screenshot

**Remediation**

Never store passwords in a file. Save passwords instead in a password manager like [1Password](https://1password.com/), [keepass](https://keepass.info/), [C2 Password](https://c2.synology.com/) or an other. Overthinking the Password policy can protect an attacker from abusing the system. Even if the passwords are stored in a password manager and the passwords cannot be found in a common password list such as rockyou.txt it is still possible to gain access to the system using brute force methods. Password manager generate passwords in various length and characters - and you dont have to remember them.



### Internal Penetration Test Findings

Finding IPT-001: Insufficient Privileged User Management (<mark style="color:red;">Critical</mark>)

<table data-header-hidden><thead><tr><th width="137"></th><th></th></tr></thead><tbody><tr><td>Description:</td><td>The user Bob on the system has higher privileges as needed. This includes that SeImpersonatePrivilege is enabled and an attacker can abuse the user account with a malicious file to escalate privileges to Administrator and hijack the system.</td></tr><tr><td>Risk:</td><td>Likelihood: High - The malicious file can be uploaded and executed.<br><br>Impact: Very High - Hijacking of the system.</td></tr><tr><td>System:</td><td>All</td></tr><tr><td>Tools Used:</td><td>PrintSpoofer64.exe</td></tr><tr><td>References:</td><td><a href="https://cwe.mitre.org/data/definitions/250.html">CWE-250: Execution with Unnecessary Privileges</a><br><a href="https://cwe.mitre.org/data/definitions/269.html">CWE-269: Improper Privilege Management</a></td></tr></tbody></table>

**Evidence**

screenshot

**Remediation**

Limit local admin users via least privilege. Disable all privileges on all users.



Finding IPT-002: Steps to NT Authority\system (<mark style="color:blue;">Informational</mark>)

The steps below describe how the penetration tester obtained nt authority\system access. Each step also provides remediation recommendations to help mitigate risk.

<table><thead><tr><th width="82">Step</th><th>Action</th><th>Remediation</th></tr></thead><tbody><tr><td>1</td><td>Login with found credentials on unauthenticated Samba share.</td><td>Secure Samba share with a strong password.</td></tr><tr><td>2</td><td>Uploaded PrintSpooferx64.exe as local administrator</td><td>Limit local administrator privileges and enforce least privilege.</td></tr><tr><td>3</td><td>Run PrintSpooferx64.exe</td><td>Disable SeImpersonatePrivilege on all Users</td></tr></tbody></table>

**Remediation**

Review action and remediation steps.

### Cleanup

xxx

## Additional reporting

Here you can see the [Additional Scans and Reports](../../../../additional-scans-and-reports.md) of this Penetration test.
